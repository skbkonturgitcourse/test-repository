"use strict";!function(e,t){const n=e.ymab;if("ymab"in e&&"function"==typeof n&&n.inited)return;let r=e.requestAnimationFrame;const i=e.location,o=e.history,s=100,a=1e4/s,c={},l={},u={},f={enableRedir:!0,enableVisual:!0,enableHTML:!0,enableJS:!1,enableWatch:!1,enableAdv:!0,storeRedirParam:!0,metrikaTimeout:100,cookieDomain:void 0,nonce:void 0,storeReferer:!1},d={enableRedir:["boolean"],enableVisual:["boolean"],enableHTML:["boolean"],enableJS:["boolean"],enableWatch:["boolean"],enableAdv:["boolean"],cookieDomain:["string"],metrikaTimeout:["number"],storeRedirParam:["boolean","string"],storeReferer:["boolean"],nonce:["string"]},h={};let m="https://uaas.yandex.ru/v1/exps/";const p="_ymab_param",v=60,b=365*(24*(60*v)),g=/\/$/;let y;function _({name:e,value:n,domain:r,ttl:o=b}){let s=`${e}=${n}; path=/;`;if("https:"===i.protocol&&(s+="SameSite=None; Secure;"),r){const e="."===r[0]?1:0;i.hostname.indexOf(r.slice(e))>=0?s+=`domain=${r};`:console.error(`cookieDomain=${r} is not valid for current hostname`)}t.cookie=s+`max-age=${o};`}function x(e){const n=new RegExp(`(?:^|; )${e}=([^;]*)`,"g");let r,i;for(;null!==(i=n.exec(t.cookie));)r=i[1];return r}function S(e,t){const n=e.indexOf(t);if(-1===n)return[];return[e.slice(0,n).trim(),e.slice(n+1)]}function k(e,t){return e.reduce(((e,{t:n,n:r,v:i})=>{if("visual"===n&&t.enableVisual){const[n,o]=S(i,"|");if(!n||void 0===o)return e;switch(r){case"css-insert":return e.cssInsert.unshift({selector:n,value:o}),e;case"text-insert":return e.textInsert.unshift({selector:n,value:o}),e;case"href-insert":return e.hrefInsert.unshift({selector:n,value:o}),e;case"image-insert":return e.imageSrcInsert.unshift({selector:n,value:o}),e;case"html-replace":if(!t.enableHTML)break;return e.htmlReplace.unshift({selector:n,value:o}),e;case"js-insert":if(!t.enableJS)break;return e.jsInsert.unshift({selector:n,value:o}),e}}if("redir"===n&&t.enableRedir)return e.redirect.push(i),e;if("adv"===n&&t.enableAdv)return e.adv.push({type:r,value:i}),e;let o=e.flags[r];return o||(e.flags[r]=o=[]),o.push(i),e}),{cssInsert:[],textInsert:[],redirect:[],hrefInsert:[],imageSrcInsert:[],htmlReplace:[],jsInsert:[],adv:[],flags:{}})}function T(e,n,r,i){try{const n=t.createElement("script");n.nonce=e,n.setAttribute("type","text/javascript"),n.innerHTML=`(function(element){${r}})(document.querySelector('${i}'));`,t.body.appendChild(n)}catch(n){}}const w={};function I(e){if(w[e])return;const n=t.createElement("script");n.async=!0,n.type="text/javascript",n.src=e;const r=t.head;r.insertBefore(n,r.firstChild),w[e]=!0}const j=new Set(["js-insert","css-insert"]),R={cache:{},getItem(e,t){let n=this.cache[e];n||(n=this.cache[e]={});let r=n[t.selector];r||(r=n[t.selector]={});let i=r[t.value];return i||(i=r[t.value]=new Set),i},has(e,t,n){return j.has(e)&&this.getItem(e,t).has(n)},add(e,t,n){return this.getItem(e,t).add(n)}};function q(e,n,r,i){const{selector:o,value:a}=r;if(!o||void 0===a)return;const c=function(e){return e?t.querySelector(e):void 0}(o);c?R.has(e,r,c)||(n(c,a,o),R.add(e,r,c)):i>0&&setTimeout((()=>q(e,n,r,i-1)),s)}function O(e,t,n,r){n.forEach((n=>q(e,t,n,r?a:0)))}const E=new class{constructor(){this.callbacks={},this.MAX_DEPTH=1e3,this.depth=0,this.started=!1,this.item=new e.MutationObserver((()=>{if(this.depth++>=this.MAX_DEPTH)return this.item.disconnect(),void r((()=>this.observe()));Object.values(this.callbacks).forEach((e=>e())),clearTimeout(this.depthTimeout),this.depthTimeout=setTimeout((()=>{this.depth=0}),0)}))}observe(){this.item.observe(t.body,{subtree:!0,childList:!0,characterData:!0,attributes:!0,attributeFilter:["class"]})}start(e,t){this.callbacks[e]=t,this.started||(this.observe(),this.started=!0)}},$=O.bind(null,"text-insert",((e,t)=>e.textContent===t||(e.textContent=t))),A=O.bind(null,"href-insert",((e,t)=>e.getAttribute("href")===t.trim()||e.setAttribute("href",t.trim()))),C=O.bind(null,"image-insert",((e,t)=>e.getAttribute("src")===t.trim()||e.setAttribute("src",t.trim()))),L=O.bind(null,"html-replace",((e,t)=>e.innerHTML===t||(e.innerHTML=t))),P=O.bind(null,"css-insert",(function(e,t){try{const n=t.trim().split(";");for(const t of n)if(t){const[n,r]=S(t,":");n&&void 0!==r&&(e.style[n]=r)}}catch(e){}})),D=(e,t,n)=>{O("js-insert",T.bind(null,t),e,n)};function M(t){var n,r;const i=e[`yaCounter${t}`];if(!i)try{const i=(null===(r=null===(n=e.Ya)||void 0===n?void 0:n._metrika)||void 0===r?void 0:r.counters)||{};return i[Object.keys(i).find((e=>0===e.indexOf(`${t}:`)))||""]}catch(e){}return i}let N=!1;function J(t,n){return new Promise((r=>{var i;const o=S(t,".")[1];if(o)try{null===(i=e.ym)||void 0===i||i.call(e,o,"experiments",n)}catch(e){}!function e(){if(!o)return void console.error(`Bad clientId = ${t}`);const i=M(o);if(i){try{i.experiments(n)}catch(e){}N=!0,r(!0)}else setTimeout(e,10)}()}))}function H(e,t=i.href){if(0===e.length)return;const n=new URL(t),r=new URL(e,n.toString()),o=r.searchParams;r.protocol=n.protocol,r.hostname=n.hostname;let s=0,a=!0;return n.searchParams.forEach(((e,t)=>{if("ab__exp_flags"===t||"vq__redir_param"===t)return void o.delete(t);const n="vq__ab_redir"===t,r=o.get(t);if(null===r){if(n)return;o.set(t,e)}else a&&!n&&r!==e&&(a=!1);s++})),a&&(a=s===Array.from(o.keys()).length),a&&n.pathname.replace(g,"")===r.pathname.replace(g,"")?void 0:r}function U(n,r,o,s){if(r){if(n.storeReferer&&t.referrer)try{const n={referer:t.referrer,url:i.href,ts:Date.now()};e.sessionStorage.setItem("vq__referer",JSON.stringify(n))}catch(e){}switch(n.storeRedirParam){case!0:case"localstorage":const t={experiments:r,ts:Date.now(),target:o.toString()};e.localStorage.setItem("vq__redir_param",JSON.stringify(t));break;case"cookie":_({name:"vq__redir_param",value:r,ttl:5*v,domain:n.cookieDomain});break;case"get":o.searchParams.set("vq__redir_param",r);break;default:s()}}}function F(e,t,n){if("string"!=typeof n||0===n.length)return;let r=n;try{const o=new URL(n,i.href);U(e,t,o,(()=>console.error("storeRedirParam is required"))),r=o.toString()}catch(e){console.error(e)}return r}function V(e,t,n){W("vq__ab_redir"),n.length&&function(e,t){let n=6,r=0;!function i(){var o;try{for(;r<t.length;r++)null===(o=t[r])||void 0===o||o.call(null,e)}catch(e){n-- >0?setTimeout(i,50):console.error(e)}}()}(t,n),function(e){if(!y||"object"!=typeof y)return;!0===y[e]&&(y[e]=!1);const{callback:t}=y;if(t){for(const[e,t]of Object.entries(y)){const[n,r]=S(e,".");if(n&&r&&!0===t&&n.length>0&&!isNaN(Number(r)))return}setTimeout(t,0)}}(e)}function W(e){const t=new URL(i.href),n=t.searchParams;if(n.has(e)){const r=n.get(e);try{n.delete(e),o.replaceState(o.state,"",t.toString())}catch(e){}return r||void 0}}function X(n,o,s,a){if("string"!=typeof n)throw new Error("clientId: should be string");u[n]=!0;let d=10;const b=new URL(m),g=b.searchParams;g.set("client_id",String(n)),g.set("url",i.href),g.set("i",o||x(p)||""),s&&g.set("client_features",JSON.stringify(s));const y=b.toString(),T=l[y];if(T)return a(T);const w=c[y]||(c[y]=[]);if(w.push(a),w.length>1)return;function j(){if(l[y])return;const e={flags:{},i:o,experiments:void 0,prepareUrl:e=>"string"==typeof e?e:void 0};l[y]=e,J(n,"wSIKtymTfos,"),V(n,e,w)}const R=setTimeout(j,5e3);function q(s){var a,c;const u=h[n]||f,{flags:d,cssInsert:m,textInsert:b,hrefInsert:g,jsInsert:T,imageSrcInsert:j,redirect:q,htmlReplace:O,adv:X}=k(s.flags,u),Y=Object.assign(Object.assign({},s),{flags:d,prepareUrl:F.bind(null,u,s.experiments)});s.i&&(o=s.i);const z=function(t){try{switch(t.storeRedirParam){case"cookie":{const e=x("vq__redir_param");return _({name:"vq__redir_param",value:"",ttl:0,domain:t.cookieDomain}),e}case"get":return W("vq__redir_param");case"localstorage":case!0:{const t=e.localStorage,n=t.getItem("vq__redir_param");let r;if(n){const e=JSON.parse(n);e.ts>Date.now()-5*v*1e3&&(r=e.experiments)}return t.removeItem("vq__redir_param"),r||void 0}}}catch(e){}}(u);let B=Promise.resolve();z&&z!==s.experiments&&(B=B.then((()=>J(n,z)))),B=B.then((()=>J(n,s.experiments)));try{const r=e.sessionStorage,o=r.getItem("vq__referer");if(o){const s=JSON.parse(o);s&&s.ts>Date.now()-5*v*1e3&&s.url===t.referrer&&(B=B.then((()=>{!function(t,n){var r;const o=S(t,".")[1];if(o){const t=M(o);t?t.hit(i.href,{referer:n}):null===(r=e.ym)||void 0===r||r.call(e,o,"hit",i.href,{referer:n})}}(n,s.referer),r.removeItem("vq__referer")})))}}catch(e){}function G(e=!1){O.length&&L(O,e),g.length&&A(g,e),j.length&&C(j,e),b.length&&$(b,e),m.length&&P(m,e),T.length&&D(T,u.nonce,e)}clearTimeout(R),l[y]=Y,Y.i&&_({name:p,value:Y.i,domain:u.cookieDomain}),q.length&&function(e,t,n){let r;for(const t of e)if(r=H(t),r)break;if(!r)return!1;let o=0;try{U(t,n,r,(()=>o=t.metrikaTimeout))}catch(e){o=t.metrikaTimeout}const s=r.toString();let a,c;function l(){clearTimeout(c),clearTimeout(a),i.replace(s)}return c=setTimeout(l,o),function e(){N?l():a=setTimeout(e,10)}(),!0}(q,u,s.experiments)||(r((function(){u.enableVisual&&(m.length&&function(e,n){const r=[];for(const{selector:t,value:n}of e){const e=n.trim();r.push(`${t} {${e}}`)}try{const e=t.createElement("style");e.nonce=n,e.setAttribute("type","text/css"),e.textContent=r.join("\n").replace(/;/g," !important;"),t.body.appendChild(e)}catch(e){}}(m,u.nonce),u.enableWatch&&E.start(n,G),G(!u.enableWatch)),V(n,Y,w)})),X.length&&(e.yaContextCb||(e.yaContextCb=[]),(null===(c=null===(a=e.Ya)||void 0===a?void 0:a.Context)||void 0===c?void 0:c.AdvManager)||I("https://yandex.ru/ads/system/context.js"),r((function(){for(const{type:t,value:n}of X)try{const r=JSON.parse(n);if("object"!=typeof r||null===r)continue;e.yaContextCb.push((()=>{var n,i;const o=null===(i=null===(n=e.Ya)||void 0===n?void 0:n.Context)||void 0===i?void 0:i.AdvManager;if(!o)return;const s=o.getPlatform(),a=r[s];a&&a.id&&o.render({type:t,platform:s,blockId:a.id,renderTo:a.renderTo})}))}catch(e){}}))))}try{localStorage.removeItem("vq__redirect_param")}catch(e){}Y(y,q,(function e(){if(--d>0)return Y(y,q,e);clearTimeout(R),j()}))}function Y(e,t,n){const r=new XMLHttpRequest;return r.open("GET",e),r.addEventListener("load",(function(){if(200!==r.status)n(r.statusText);else try{const e=JSON.parse(r.responseText);t(e)}catch(e){e instanceof Error&&n(e.message)}})),r.addEventListener("error",(()=>n(r.statusText))),r.send()}const z={init:(e,t,n,r)=>{X(e,t,n,(e=>r&&r(e)))},getFlags:(e,t,n,r)=>{X(e,t,n,(e=>r&&r(e.flags)))},getExperiments:(e,t,n,r)=>{X(e,t,n,(e=>r&&r(e.experiments)))},getParam:(e,t,n,r)=>{X(e,t,n,(e=>r&&r(e.i)))},setConfig:(e,t,n,r)=>{B(e,n),r&&r()},getConfig:(e,t,n,r)=>{const i=h[e]||f,o=Object.assign({},i);delete o.nonce,r&&r(o)}};function B(e,t){var n;if("object"==typeof t){const r=h[e]||(h[e]=Object.assign({},f)),i=Object.keys(t);for(const e of i)if(e in r){const i=e,o=t[i];(null===(n=d[i])||void 0===n?void 0:n.includes(typeof o))&&(r[i]=o)}}}function G(e,t,n,r,i){if("object"==typeof e)return function(e){const{clientId:t,config:n}=e;if(!t)throw new Error("clientId is required");B(t,n),z.init(t,e.i,e.clientFeatures,e.callback)}(e);if(!t)throw new Error("method not specified");if(!(t in z))throw new Error("unknown method");"function"==typeof r&&(i=r,r={}),"function"==typeof n&&(i=n,n=void 0),"object"==typeof n&&(r=n,n=void 0),r||(r={}),z[t](e,n,r,i)}n&&(Array.isArray(n.a)&&n.a.forEach((e=>G.apply(null,e))),"object"==typeof n.antiFlicker&&(y=n.antiFlicker)),G.inited=!0,e.ymab=G,function(e){const t=["ru","ua","by","kz","com","com.tr"];function n(e){const n=new URL(e),{hostname:r,protocol:i}=n,o=(null==r?void 0:r.split("."))||[];"test"===o[1]&&o.splice(1,1);const[s,a,...c]=o,l=c.join(".");return"https:"===i&&"ab"===s&&"yandex"===a&&-1!==t.indexOf(l)}e.addEventListener("message",(function(e){const t=e.origin;if(!t||!n(t))return;const r=function(e){if(!e)return null;if("string"!=typeof e)return e;try{return JSON.parse(e)}catch(e){return null}}(e.data);var i,o;if(r&&u[r.clientId]&&"appendplugin"===r.type)i=r.plugin,o=r.version,/^(\d\.)+\d+$/.test(o)&&/^[a-z0-9-]+$/gi.test(i)&&I(`https://abt.s3.yandex.net/${i}/v${o}/main.js`)}))}(e)}(window,document);